<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Richiesta Sconto</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #f2f2f2;
    }
    form {
      background-color: #fff;
      padding: 20px;
      border-radius: 8px;
      max-width: 500px;
      margin: auto;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    label {
      display: block;
      margin-top: 15px;
    }
    input, select, button {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    button {
      background-color: #007bff;
      color: white;
      font-weight: bold;
      cursor: pointer;
      margin-top: 20px;
    }
    button:hover {
      background-color: #0056b3;
    }
  </style>
</head>
<body>

<h2>Richiesta Sconto</h2>

<form id="formRichiesta" onsubmit="inviaRichiesta(event)">
  <label for="pv">Punto Vendita</label>
  <select id="pv" name="pv" required>
    <option value="">-- Seleziona --</option>
    <option value="Fano">Fano</option>
    <option value="Monsano">Monsano</option>
    <option value="Osimo">Osimo</option>
    <option value="Macerata">Macerata</option>
    <option value="Civitanova">Civitanova</option>
    <option value="Pesaro">Pesaro</option>
  </select>

  <label for="prodotto">Prodotto</label>
  <select id="prodotto" name="prodotto" required>
    <option value="">-- Seleziona --</option>
    <option value="BIANCO">BIANCO</option>
    <option value="BRUNO">BRUNO</option>
  </select>

  <label for="codProd">Codice Prodotto</label>
  <input type="text" id="codProd" name="codProd" required>

  <label for="cliente">Cliente</label>
  <input type="text" id="cliente" name="cliente" required>

  <label for="dataVendita">Data Vendita</label>
  <input type="date" id="dataVendita" name="dataVendita" required>

  <label for="prezzoPartenza">Prezzo Partenza</label>
  <input type="number" id="prezzoPartenza" name="prezzoPartenza" required>

  <label for="prezzoScontato">Prezzo Scontato</label>
  <input type="number" id="prezzoScontato" name="prezzoScontato" required>

  <label for="sconto">Sconto (%)</label>
  <input type="number" id="sconto" name="sconto" required>

  <button type="submit">Invia Richiesta</button>
</form>

<script>
  function inviaRichiesta(event) {
    event.preventDefault();

    const dati = {
      pv: document.getElementById("pv").value,
      prodotto: document.getElementById("prodotto").value,
      codProd: document.getElementById("codProd").value,
      cliente: document.getElementById("cliente").value,
      dataVendita: document.getElementById("dataVendita").value,
      prezzoPartenza: parseFloat(document.getElementById("prezzoPartenza").value),
      prezzoScontato: parseFloat(document.getElementById("prezzoScontato").value),
      sconto: parseFloat(document.getElementById("sconto").value)
    };

    fetch("https://script.google.com/macros/s/AKfycbxKOiZb26RGycpBeCyAjYyDqbDrdHSJ3ZOfyGJzEOTMnHHA4TIkK-6Wr30RuycwMfAr3w/exec", {
      method: "POST",
      body: JSON.stringify(dati),
      headers: {
        "Content-Type": "application/json"
      }
    })
    .then(res => res.text())
    .then(risposta => {
      alert("Richiesta inviata con successo!");
      document.getElementById("formRichiesta").reset();
    })
    .catch(err => {
      alert("Errore nell'invio. Riprova.");
      console.error("Errore:", err);
    });
  }
</script>

</body>
</html>
